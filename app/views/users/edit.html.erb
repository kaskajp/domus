<% content_for :title, "Edit Profile - Domus" %>

<div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-900">Edit Profile</h1>
    <p class="text-gray-600 mt-1">Update your account information</p>
  </div>

  <div class="bg-white shadow rounded-lg">
    <div class="px-6 py-6">
      <%= form_with model: @user, local: true, class: "space-y-6" do |form| %>
        <% if @user.errors.any? %>
          <div class="bg-red-50 border border-red-200 rounded-md p-4">
            <h3 class="text-sm font-medium text-red-800">Please fix the following errors:</h3>
            <ul class="mt-2 text-sm text-red-700">
              <% @user.errors.full_messages.each do |message| %>
                <li>â€¢ <%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <!-- Basic Information -->
        <div>
          <h3 class="text-lg font-medium text-gray-900 mb-4">Basic Information</h3>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-group">
              <%= form.label :first_name, class: "form-label" %>
              <%= form.text_field :first_name, 
                  required: true, 
                  autofocus: true,
                  placeholder: "First name",
                  class: "form-input" %>
            </div>

            <div class="form-group">
              <%= form.label :last_name, class: "form-label" %>
              <%= form.text_field :last_name, 
                  required: true,
                  placeholder: "Last name",
                  class: "form-input" %>
            </div>
          </div>

          <div class="form-group">
            <%= form.label :email, class: "form-label" %>
            <%= form.email_field :email, 
                required: true,
                placeholder: "Enter your email",
                class: "form-input" %>
            <p class="text-xs text-gray-500 mt-1">
              This is used for signing in and account recovery
            </p>
          </div>
        </div>

        <!-- Password Section -->
        <div>
          <h3 class="text-lg font-medium text-gray-900 mb-4">Change Password</h3>
          <p class="text-sm text-gray-600 mb-4">
            Leave password fields blank if you don't want to change your password
          </p>

          <div class="form-group">
            <%= form.label :password, "New Password", class: "form-label" %>
            <%= form.password_field :password, 
                placeholder: "Enter new password (optional)",
                class: "form-input" %>
            <p class="text-xs text-gray-500 mt-1">Must be at least 6 characters long</p>
          </div>

          <div class="form-group">
            <%= form.label :password_confirmation, "Confirm New Password", class: "form-label" %>
            <%= form.password_field :password_confirmation, 
                placeholder: "Confirm new password",
                class: "form-input" %>
          </div>
        </div>

        <!-- Account Information -->
        <div>
          <h3 class="text-lg font-medium text-gray-900 mb-4">Account Information</h3>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700">Role</label>
              <div class="mt-1">
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                           <%= @user.admin? ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800' %>">
                  <%= @user.admin? ? 'Admin' : 'User' %>
                </span>
                <p class="text-xs text-gray-500 mt-1">Contact an admin to change your role</p>
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700">Account Status</label>
              <div class="mt-1">
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                           <%= @user.confirmed? ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800' %>">
                  <%= @user.confirmed? ? 'Confirmed' : 'Pending Confirmation' %>
                </span>
                <% unless @user.confirmed? %>
                  <p class="text-xs text-gray-500 mt-1">Your account is pending admin approval</p>
                <% end %>
              </div>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="pt-6 border-t border-gray-200">
          <div class="flex items-center justify-between">
            <%= link_to "Cancel", @user, class: "btn btn-secondary" %>
            <div class="flex space-x-3">
              <%= form.submit "Save Changes", class: "btn btn-primary" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<style>
.space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 1.5rem; }
.space-x-3 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.75rem; }
.grid { display: grid; }
.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
.gap-4 { gap: 1rem; }
.text-xs { font-size: 0.75rem; }
.text-gray-500 { color: #6b7280; }
.text-red-700 { color: #b91c1c; }
.text-red-800 { color: #991b1b; }
.mt-1 { margin-top: 0.25rem; }

@media (min-width: 768px) {
  .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
}

.bg-purple-100 { background-color: #f3e8ff; }
.text-purple-800 { color: #6b21a8; }
.bg-blue-100 { background-color: #dbeafe; }
.text-blue-800 { color: #1e40af; }
.bg-green-100 { background-color: #dcfce7; }
.text-green-800 { color: #166534; }
.bg-yellow-100 { background-color: #fef3c7; }
.text-yellow-800 { color: #92400e; }
</style> 